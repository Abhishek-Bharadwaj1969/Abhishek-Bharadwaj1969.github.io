<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Hugo 0.89.4" />
  
  <meta name="description" content="Define the Problem The sinking of the RMS Titanic is one of the most infamous shipwrecks in history. On April 15, 1912, during her maiden voyage, the Titanic sank after colliding with an iceberg, killing 1502 out of 2224 passengers and crew. This sensational tragedy shocked the international community and led to better safety regulations for ships. One of the reasons that the shipwreck led to such loss of life was that there were not enough lifeboats for the passengers and crew.">
  <link rel="stylesheet" href="https://example.com/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  
  
  
  <link rel="stylesheet" href="https://example.com/css/cayman.ea0e967413f3851071cc8ace3621bc4205fe8fa79b2abe3d7bf94ff2841f0d47.css">
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

  <title>Predicting the Survival of Titanic Passengers | ABhishek Bharadwaj</title>
</head>

<body>
  <section class="page-header">
  <h1 class="project-name">
    ABhishek Bharadwaj
  </h1>
  <h2 class="project-tagline">
    A Simple Blog
  </h2>
  <nav>
    
    
      
      
      
      
      <a href="/" class="btn">Blog</a>
    
      
      
      
      
      <a href="/tags/" class="btn">Tags</a>
    
      
      
      
      
      <a href="/about/" class="btn">About</a>
    
  </nav>
</section>

  <section class="main-content">
    
  <h1>Predicting the Survival of Titanic Passengers</h1>
  <h2 id="define-the-problem">Define the Problem</h2>
<p>The sinking of the RMS Titanic is one of the most infamous shipwrecks in history. On April 15, 1912, during her maiden voyage, the Titanic sank after colliding with an iceberg, killing 1502 out of 2224 passengers and crew. This sensational tragedy shocked the international community and led to better safety regulations for ships.
One of the reasons that the shipwreck led to such loss of life was that there were not enough lifeboats for the passengers and crew. Although there was some element of luck involved in surviving the sinking, some groups of people were more likely to survive than others, such as women, children, and the upper-class.
In this challenge, we will complete the analysis of what sorts of people were likely to survive.</p>
<h2 id="data-collection">Data Collection</h2>
<p>The dataset is also given to us on a golden platter with test and train data at <a href="https://www.kaggle.com/c/titanic/data">Kaggle&rsquo;s Titanic: Machine Learning from Disaster</a></p>
<h2 id="prepare-data-for-consumption">Prepare Data for consumption</h2>
<p>Since Dataset was already provided to us on a golden platter. Normal processes in data wrangling, such as data architecture, governance, and extraction are out of scope. Thus, only data cleaning is in scope.</p>
<ul>
<li>We used the popular scikit-learn library to develop our machine learning algorithms.</li>
<li>For data visualization, we will use the matplotlib and seaborn library.</li>
</ul>
<h3 id="importing-libraries">Importing Libraries</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">sys</span> 
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">pandas</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">pd</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">matplotlib</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">numpy</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">np</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">scipy</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">sp</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">IPython</span>
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">IPython</span> <span style="color:#008000;font-weight:bold">import</span> display
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">sklearn</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">random</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">time</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">warnings</span>
warnings<span style="color:#666">.</span>filterwarnings(<span style="color:#ba2121">&#39;ignore&#39;</span>)
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">subprocess</span> <span style="color:#008000;font-weight:bold">import</span> check_output
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.preprocessing</span> <span style="color:#008000;font-weight:bold">import</span> LabelEncoder
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">matplotlib.pyplot</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">plt</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">seaborn</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">sns</span>
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.ensemble</span> <span style="color:#008000;font-weight:bold">import</span> RandomForestClassifier
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.neighbors</span> <span style="color:#008000;font-weight:bold">import</span> KNeighborsClassifier
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.gaussian_process</span> <span style="color:#008000;font-weight:bold">import</span> GaussianProcessClassifier
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.linear_model</span> <span style="color:#008000;font-weight:bold">import</span> LogisticRegressionCV
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.naive_bayes</span> <span style="color:#008000;font-weight:bold">import</span> GaussianNB
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.model_selection</span> <span style="color:#008000;font-weight:bold">import</span> cross_validate 
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.neighbors</span> <span style="color:#008000;font-weight:bold">import</span> KNeighborsClassifier
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.tree</span> <span style="color:#008000;font-weight:bold">import</span> DecisionTreeClassifier
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.model_selection</span> <span style="color:#008000;font-weight:bold">import</span> <span style="color:#666">*</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">pandas</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">pd</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">sklearn.metrics</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">metrics</span>
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.feature_selection</span> <span style="color:#008000;font-weight:bold">import</span> <span style="color:#666">*</span>
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.tree</span> <span style="color:#008000;font-weight:bold">import</span> <span style="color:#666">*</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">graphviz</span> 
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.ensemble</span> <span style="color:#008000;font-weight:bold">import</span> <span style="color:#666">*</span>
</code></pre></div><h3 id="meet-and-greet-data">Meet and Greet Data</h3>
<p>This is the meet and greet step. Get to know your data by first name and learn a little bit about it. What does it look like (datatype and values), what makes it tick (independent/feature variables(s)), what&rsquo;s its goals in life (dependent/target variable(s)).</p>
<p>We have imported the data and used sample() and info() functions to achieve this.</p>
<ul>
<li>
<p>The Survived variable is our outcome or dependent variable. It is a binary nominal datatype of 1 for survived and 0 for did not survive. All other variables are potential predictor or independent variables. It&rsquo;s important to note, more predictor variables do not make a better model, but the right variables.</p>
</li>
<li>
<p>The PassengerID and Ticket variables are assumed to be random unique identifiers, that have no impact on the outcome variable. Thus, they will be excluded from analysis.</p>
</li>
<li>
<p>The Pclass variable is an ordinal datatype for the ticket class, a proxy for socio-economic status (SES), representing 1 = upper class, 2 = middle class, and 3 = lower class.</p>
</li>
<li>
<p>The Name variable is a nominal datatype. It could be used in feature engineering to derive the gender from title, family size from surname, and SES from titles like doctor or master. Since these variables already exist, we&rsquo;ll make use of it to see if title, like master, makes a difference.</p>
</li>
<li>
<p>The Sex and Embarked variables are a nominal datatype. They will be converted to dummy variables for mathematical calculations.</p>
</li>
<li>
<p>The Age and Fare variable are continuous quantitative datatypes.</p>
</li>
<li>
<p>The SibSp represents number of related siblings/spouse aboard and Parch represents number of related parents/children aboard. Both are discrete quantitative datatypes. This can be used for feature engineering to create a family size and is alone variable.</p>
</li>
<li>
<p>The Cabin variable is a nominal datatype that can be used in feature engineering for approximate position on ship when the incident occurred and SES from deck levels. However, since there are many null values, it does not add value and thus is excluded from analysis.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">data_raw <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_csv(<span style="color:#ba2121">&#39;./data/train.csv&#39;</span>)
data_val  <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_csv(<span style="color:#ba2121">&#39;./data/test.csv&#39;</span>)
data1 <span style="color:#666">=</span> data_raw<span style="color:#666">.</span>copy(deep <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>)
data_cleaner <span style="color:#666">=</span> [data1, data_val]
<span style="color:#008000">print</span> (data_raw<span style="color:#666">.</span>info())
data_raw<span style="color:#666">.</span>sample(<span style="color:#666">10</span>)
</code></pre></div><h2 id="4-cs-of-data-cleaning-correcting-completing-creating-and-converting">4 C&rsquo;s of Data Cleaning: Correcting, Completing, Creating, and Converting</h2>
<p>In this stage, we will clean our data by 1) correcting aberrant values and outliers, 2) completing missing information, 3) creating new features for analysis, and 4) converting fields to the correct format for calculations and presentation.</p>
<ol>
<li>
<p>Correcting: Reviewing the data, there does not appear to be any aberrant or non-acceptable data inputs. In addition, we see we may have potential outliers in age and fare. However, since they are reasonable values, we will wait until after we complete our exploratory analysis to determine if we should include or exclude from the dataset.</p>
</li>
<li>
<p>Completing: There are null values or missing data in the age, cabin, and embarked field. Missing values can be bad, because some algorithms don&rsquo;t know how-to handle null values and will fail. While others, like decision trees, can handle null values. Thus, it&rsquo;s important to fix before we start modeling, because we will compare and contrast several models.</p>
</li>
<li>
<p>Creating: Feature engineering is when we use existing features to create new features to determine if they provide new signals to predict our outcome. For this dataset, we will create a title feature to determine if it played a role in survival.</p>
</li>
<li>
<p>Converting: Last, but certainly not least, we&rsquo;ll deal with formatting. There are no date or currency formats, but datatype formats. Our categorical data is imported as objects, which makes it difficult for mathematical calculations. For this dataset, we will convert object datatypes to categorical dummy variables.</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#008000">print</span>(<span style="color:#ba2121">&#39;Train columns with null values:</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span>, data1<span style="color:#666">.</span>isnull()<span style="color:#666">.</span>sum())
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#34;-&#34;</span><span style="color:#666">*</span><span style="color:#666">10</span>)

<span style="color:#008000">print</span>(<span style="color:#ba2121">&#39;Test/Validation columns with null values:</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span>, data_val<span style="color:#666">.</span>isnull()<span style="color:#666">.</span>sum())
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#34;-&#34;</span><span style="color:#666">*</span><span style="color:#666">10</span>)

data_raw<span style="color:#666">.</span>describe(include <span style="color:#666">=</span> <span style="color:#ba2121">&#39;all&#39;</span>)
</code></pre></div><h3 id="clean-data">Clean Data</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#008000;font-weight:bold">for</span> dataset <span style="color:#a2f;font-weight:bold">in</span> data_cleaner:    
    dataset[<span style="color:#ba2121">&#39;Age&#39;</span>]<span style="color:#666">.</span>fillna(dataset[<span style="color:#ba2121">&#39;Age&#39;</span>]<span style="color:#666">.</span>median(), inplace <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>)
    dataset[<span style="color:#ba2121">&#39;Embarked&#39;</span>]<span style="color:#666">.</span>fillna(dataset[<span style="color:#ba2121">&#39;Embarked&#39;</span>]<span style="color:#666">.</span>mode()[<span style="color:#666">0</span>], inplace <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>)
    dataset[<span style="color:#ba2121">&#39;Fare&#39;</span>]<span style="color:#666">.</span>fillna(dataset[<span style="color:#ba2121">&#39;Fare&#39;</span>]<span style="color:#666">.</span>median(), inplace <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>)
drop_column <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;PassengerId&#39;</span>,<span style="color:#ba2121">&#39;Cabin&#39;</span>, <span style="color:#ba2121">&#39;Ticket&#39;</span>]
data1<span style="color:#666">.</span>drop(drop_column, axis<span style="color:#666">=</span><span style="color:#666">1</span>, inplace <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>)

<span style="color:#008000">print</span>(data1<span style="color:#666">.</span>isnull()<span style="color:#666">.</span>sum())
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#34;-&#34;</span><span style="color:#666">*</span><span style="color:#666">10</span>)
<span style="color:#008000">print</span>(data_val<span style="color:#666">.</span>isnull()<span style="color:#666">.</span>sum())
</code></pre></div><h3 id="convert-formats">Convert Formats</h3>
<p>We will convert categorical data to dummy variables for mathematical analysis. There are multiple ways to encode categorical variables; we will use the sklearn and pandas functions.</p>
<p>In this step, we will also define our x (independent/features/explanatory/predictor/etc.) and y (dependent/target/outcome/response/etc.) variables for data modeling.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">label <span style="color:#666">=</span> LabelEncoder()
<span style="color:#008000;font-weight:bold">for</span> dataset <span style="color:#a2f;font-weight:bold">in</span> data_cleaner:    
    dataset[<span style="color:#ba2121">&#39;Sex_Code&#39;</span>] <span style="color:#666">=</span> label<span style="color:#666">.</span>fit_transform(dataset[<span style="color:#ba2121">&#39;Sex&#39;</span>])
    dataset[<span style="color:#ba2121">&#39;Embarked_Code&#39;</span>] <span style="color:#666">=</span> label<span style="color:#666">.</span>fit_transform(dataset[<span style="color:#ba2121">&#39;Embarked&#39;</span>])
    dataset[<span style="color:#ba2121">&#39;Title_Code&#39;</span>] <span style="color:#666">=</span> label<span style="color:#666">.</span>fit_transform(dataset[<span style="color:#ba2121">&#39;Title&#39;</span>])
    dataset[<span style="color:#ba2121">&#39;AgeBin_Code&#39;</span>] <span style="color:#666">=</span> label<span style="color:#666">.</span>fit_transform(dataset[<span style="color:#ba2121">&#39;AgeBin&#39;</span>])
    dataset[<span style="color:#ba2121">&#39;FareBin_Code&#39;</span>] <span style="color:#666">=</span> label<span style="color:#666">.</span>fit_transform(dataset[<span style="color:#ba2121">&#39;FareBin&#39;</span>])


Target <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;Survived&#39;</span>]

data1_x <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;Sex&#39;</span>,<span style="color:#ba2121">&#39;Pclass&#39;</span>, <span style="color:#ba2121">&#39;Embarked&#39;</span>, <span style="color:#ba2121">&#39;Title&#39;</span>,<span style="color:#ba2121">&#39;SibSp&#39;</span>, <span style="color:#ba2121">&#39;Parch&#39;</span>, <span style="color:#ba2121">&#39;Age&#39;</span>, <span style="color:#ba2121">&#39;Fare&#39;</span>, <span style="color:#ba2121">&#39;FamilySize&#39;</span>, <span style="color:#ba2121">&#39;IsAlone&#39;</span>]
data1_x_calc <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;Sex_Code&#39;</span>,<span style="color:#ba2121">&#39;Pclass&#39;</span>, <span style="color:#ba2121">&#39;Embarked_Code&#39;</span>, <span style="color:#ba2121">&#39;Title_Code&#39;</span>,<span style="color:#ba2121">&#39;SibSp&#39;</span>, <span style="color:#ba2121">&#39;Parch&#39;</span>, <span style="color:#ba2121">&#39;Age&#39;</span>, <span style="color:#ba2121">&#39;Fare&#39;</span>]
data1_xy <span style="color:#666">=</span>  Target <span style="color:#666">+</span> data1_x
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#39;Original X Y: &#39;</span>, data1_xy, <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span>)


data1_x_bin <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;Sex_Code&#39;</span>,<span style="color:#ba2121">&#39;Pclass&#39;</span>, <span style="color:#ba2121">&#39;Embarked_Code&#39;</span>, <span style="color:#ba2121">&#39;Title_Code&#39;</span>, <span style="color:#ba2121">&#39;FamilySize&#39;</span>, <span style="color:#ba2121">&#39;AgeBin_Code&#39;</span>, <span style="color:#ba2121">&#39;FareBin_Code&#39;</span>]
data1_xy_bin <span style="color:#666">=</span> Target <span style="color:#666">+</span> data1_x_bin
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#39;Bin X Y: &#39;</span>, data1_xy_bin, <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span>)



data1_dummy <span style="color:#666">=</span> pd<span style="color:#666">.</span>get_dummies(data1[data1_x])
data1_x_dummy <span style="color:#666">=</span> data1_dummy<span style="color:#666">.</span>columns<span style="color:#666">.</span>tolist()
data1_xy_dummy <span style="color:#666">=</span> Target <span style="color:#666">+</span> data1_x_dummy
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#39;Dummy X Y: &#39;</span>, data1_xy_dummy, <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span>)



data1_dummy<span style="color:#666">.</span>head()

</code></pre></div><h3 id="double-check-cleaned-data">Double Check Cleaned Data</h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#008000">print</span>(<span style="color:#ba2121">&#39;Train columns with null values: </span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span>, data1<span style="color:#666">.</span>isnull()<span style="color:#666">.</span>sum())
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#34;-&#34;</span><span style="color:#666">*</span><span style="color:#666">10</span>)
<span style="color:#008000">print</span> (data1<span style="color:#666">.</span>info())
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#34;-&#34;</span><span style="color:#666">*</span><span style="color:#666">10</span>)

<span style="color:#008000">print</span>(<span style="color:#ba2121">&#39;Test/Validation columns with null values: </span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span>, data_val<span style="color:#666">.</span>isnull()<span style="color:#666">.</span>sum())
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#34;-&#34;</span><span style="color:#666">*</span><span style="color:#666">10</span>)
<span style="color:#008000">print</span> (data_val<span style="color:#666">.</span>info())
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#34;-&#34;</span><span style="color:#666">*</span><span style="color:#666">10</span>)

data_raw<span style="color:#666">.</span>describe(include <span style="color:#666">=</span> <span style="color:#ba2121">&#39;all&#39;</span>)
</code></pre></div><h3 id="split-training-and-testing-data">Split Training and Testing Data</h3>
<p>The test file provided is really validation data for competition submission. So, we will use sklearn function to split the training data in two datasets; 75/25 split. This is important, so we don&rsquo;t overfit our model. We will use sklearn&rsquo;s train_test_split function. we also used sklearn&rsquo;s cross validation functions, that splits our dataset into train and test for data modeling comparison.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">sklearn.model_selection</span> <span style="color:#008000;font-weight:bold">import</span> <span style="color:#666">*</span>
train1_x, test1_x, train1_y, test1_y <span style="color:#666">=</span> train_test_split(data1[data1_x_calc], data1[Target], random_state <span style="color:#666">=</span> <span style="color:#666">0</span>)
train1_x_bin, test1_x_bin, train1_y_bin, test1_y_bin <span style="color:#666">=</span> train_test_split(data1[data1_x_bin], data1[Target] , random_state <span style="color:#666">=</span> <span style="color:#666">0</span>)
train1_x_dummy, test1_x_dummy, train1_y_dummy, test1_y_dummy <span style="color:#666">=</span> train_test_split(data1_dummy[data1_x_dummy], data1[Target], random_state <span style="color:#666">=</span> <span style="color:#666">0</span>)


<span style="color:#008000">print</span>(<span style="color:#ba2121">&#34;Data1 Shape: </span><span style="color:#b68;font-weight:bold">{}</span><span style="color:#ba2121">&#34;</span><span style="color:#666">.</span>format(data1<span style="color:#666">.</span>shape))
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#34;Train1 Shape: </span><span style="color:#b68;font-weight:bold">{}</span><span style="color:#ba2121">&#34;</span><span style="color:#666">.</span>format(train1_x<span style="color:#666">.</span>shape))
<span style="color:#008000">print</span>(<span style="color:#ba2121">&#34;Test1 Shape: </span><span style="color:#b68;font-weight:bold">{}</span><span style="color:#ba2121">&#34;</span><span style="color:#666">.</span>format(test1_x<span style="color:#666">.</span>shape))

train1_x_bin<span style="color:#666">.</span>head()
</code></pre></div><h2 id="exploratory-analysis-with-statistics">Exploratory Analysis with Statistics</h2>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#008000;font-weight:bold">for</span> x <span style="color:#a2f;font-weight:bold">in</span> data1_x:
    <span style="color:#008000;font-weight:bold">if</span> data1[x]<span style="color:#666">.</span>dtype <span style="color:#666">!=</span> <span style="color:#ba2121">&#39;float64&#39;</span> :
        <span style="color:#008000">print</span>(<span style="color:#ba2121">&#39;Survival Correlation by:&#39;</span>, x)
        <span style="color:#008000">print</span>(data1[[x, Target[<span style="color:#666">0</span>]]]<span style="color:#666">.</span>groupby(x, as_index<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">False</span>)<span style="color:#666">.</span>mean())
        <span style="color:#008000">print</span>(<span style="color:#ba2121">&#39;-&#39;</span><span style="color:#666">*</span><span style="color:#666">10</span>, <span style="color:#ba2121">&#39;</span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span>)
        

<span style="color:#008000">print</span>(pd<span style="color:#666">.</span>crosstab(data1[<span style="color:#ba2121">&#39;Title&#39;</span>],data1[Target[<span style="color:#666">0</span>]]))
</code></pre></div><pre tabindex="0"><code>Survival Correlation by: Sex
      Sex  Survived
0  female  0.742038
1    male  0.188908
---------- 

Survival Correlation by: Pclass
   Pclass  Survived
0       1  0.629630
1       2  0.472826
2       3  0.242363
---------- 

Survival Correlation by: Embarked
  Embarked  Survived
0        C  0.553571
1        Q  0.389610
2        S  0.339009
---------- 

Survival Correlation by: Title
    Title  Survived
0  Master  0.575000
1    Misc  0.444444
2    Miss  0.697802
3      Mr  0.156673
4     Mrs  0.792000
---------- 

Survival Correlation by: SibSp
   SibSp  Survived
0      0  0.345395
1      1  0.535885
2      2  0.464286
3      3  0.250000
4      4  0.166667
5      5  0.000000
6      8  0.000000
---------- 

Survival Correlation by: Parch
   Parch  Survived
0      0  0.343658
1      1  0.550847
2      2  0.500000
3      3  0.600000
4      4  0.000000
5      5  0.200000
6      6  0.000000
---------- 

Survival Correlation by: FamilySize
   FamilySize  Survived
0           1  0.303538
1           2  0.552795
2           3  0.578431
3           4  0.724138
4           5  0.200000
5           6  0.136364
6           7  0.333333
7           8  0.000000
8          11  0.000000
---------- 

Survival Correlation by: IsAlone
   IsAlone  Survived
0        0  0.505650
1        1  0.303538
---------- 

Survived    0    1
Title             
Master     17   23
Misc       15   12
Miss       55  127
Mr        436   81
Mrs        26   99
</code></pre><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">plt<span style="color:#666">.</span>figure(figsize<span style="color:#666">=</span>[<span style="color:#666">16</span>,<span style="color:#666">12</span>])

plt<span style="color:#666">.</span>subplot(<span style="color:#666">231</span>)
plt<span style="color:#666">.</span>boxplot(x<span style="color:#666">=</span>data1[<span style="color:#ba2121">&#39;Fare&#39;</span>], showmeans <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>, meanline <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>)
plt<span style="color:#666">.</span>title(<span style="color:#ba2121">&#39;Fare Boxplot&#39;</span>)
plt<span style="color:#666">.</span>ylabel(<span style="color:#ba2121">&#39;Fare ($)&#39;</span>)

plt<span style="color:#666">.</span>subplot(<span style="color:#666">232</span>)
plt<span style="color:#666">.</span>boxplot(data1[<span style="color:#ba2121">&#39;Age&#39;</span>], showmeans <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>, meanline <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>)
plt<span style="color:#666">.</span>title(<span style="color:#ba2121">&#39;Age Boxplot&#39;</span>)
plt<span style="color:#666">.</span>ylabel(<span style="color:#ba2121">&#39;Age (Years)&#39;</span>)

plt<span style="color:#666">.</span>subplot(<span style="color:#666">233</span>)
plt<span style="color:#666">.</span>boxplot(data1[<span style="color:#ba2121">&#39;FamilySize&#39;</span>], showmeans <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>, meanline <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>)
plt<span style="color:#666">.</span>title(<span style="color:#ba2121">&#39;Family Size Boxplot&#39;</span>)
plt<span style="color:#666">.</span>ylabel(<span style="color:#ba2121">&#39;Family Size (#)&#39;</span>)

plt<span style="color:#666">.</span>subplot(<span style="color:#666">234</span>)
plt<span style="color:#666">.</span>hist(x <span style="color:#666">=</span> [data1[data1[<span style="color:#ba2121">&#39;Survived&#39;</span>]<span style="color:#666">==</span><span style="color:#666">1</span>][<span style="color:#ba2121">&#39;Fare&#39;</span>], data1[data1[<span style="color:#ba2121">&#39;Survived&#39;</span>]<span style="color:#666">==</span><span style="color:#666">0</span>][<span style="color:#ba2121">&#39;Fare&#39;</span>]], 
         stacked<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">True</span>, color <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;g&#39;</span>,<span style="color:#ba2121">&#39;r&#39;</span>],label <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;Survived&#39;</span>,<span style="color:#ba2121">&#39;Dead&#39;</span>])
plt<span style="color:#666">.</span>title(<span style="color:#ba2121">&#39;Fare Histogram by Survival&#39;</span>)
plt<span style="color:#666">.</span>xlabel(<span style="color:#ba2121">&#39;Fare ($)&#39;</span>)
plt<span style="color:#666">.</span>ylabel(<span style="color:#ba2121">&#39;# of Passengers&#39;</span>)
plt<span style="color:#666">.</span>legend()

plt<span style="color:#666">.</span>subplot(<span style="color:#666">235</span>)
plt<span style="color:#666">.</span>hist(x <span style="color:#666">=</span> [data1[data1[<span style="color:#ba2121">&#39;Survived&#39;</span>]<span style="color:#666">==</span><span style="color:#666">1</span>][<span style="color:#ba2121">&#39;Age&#39;</span>], data1[data1[<span style="color:#ba2121">&#39;Survived&#39;</span>]<span style="color:#666">==</span><span style="color:#666">0</span>][<span style="color:#ba2121">&#39;Age&#39;</span>]], 
         stacked<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">True</span>, color <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;g&#39;</span>,<span style="color:#ba2121">&#39;r&#39;</span>],label <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;Survived&#39;</span>,<span style="color:#ba2121">&#39;Dead&#39;</span>])
plt<span style="color:#666">.</span>title(<span style="color:#ba2121">&#39;Age Histogram by Survival&#39;</span>)
plt<span style="color:#666">.</span>xlabel(<span style="color:#ba2121">&#39;Age (Years)&#39;</span>)
plt<span style="color:#666">.</span>ylabel(<span style="color:#ba2121">&#39;# of Passengers&#39;</span>)
plt<span style="color:#666">.</span>legend()

plt<span style="color:#666">.</span>subplot(<span style="color:#666">236</span>)
plt<span style="color:#666">.</span>hist(x <span style="color:#666">=</span> [data1[data1[<span style="color:#ba2121">&#39;Survived&#39;</span>]<span style="color:#666">==</span><span style="color:#666">1</span>][<span style="color:#ba2121">&#39;FamilySize&#39;</span>], data1[data1[<span style="color:#ba2121">&#39;Survived&#39;</span>]<span style="color:#666">==</span><span style="color:#666">0</span>][<span style="color:#ba2121">&#39;FamilySize&#39;</span>]], 
         stacked<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">True</span>, color <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;g&#39;</span>,<span style="color:#ba2121">&#39;r&#39;</span>],label <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;Survived&#39;</span>,<span style="color:#ba2121">&#39;Dead&#39;</span>])
plt<span style="color:#666">.</span>title(<span style="color:#ba2121">&#39;Family Size Histogram by Survival&#39;</span>)
plt<span style="color:#666">.</span>xlabel(<span style="color:#ba2121">&#39;Family Size (#)&#39;</span>)
plt<span style="color:#666">.</span>ylabel(<span style="color:#ba2121">&#39;# of Passengers&#39;</span>)
plt<span style="color:#666">.</span>legend()
</code></pre></div><p><img src="https://i.imgur.com/n6MIgFz.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">fig, saxis <span style="color:#666">=</span> plt<span style="color:#666">.</span>subplots(<span style="color:#666">2</span>, <span style="color:#666">3</span>,figsize<span style="color:#666">=</span>(<span style="color:#666">16</span>,<span style="color:#666">12</span>))

sns<span style="color:#666">.</span>barplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Embarked&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, data<span style="color:#666">=</span>data1, ax <span style="color:#666">=</span> saxis[<span style="color:#666">0</span>,<span style="color:#666">0</span>])
sns<span style="color:#666">.</span>barplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Pclass&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, order<span style="color:#666">=</span>[<span style="color:#666">1</span>,<span style="color:#666">2</span>,<span style="color:#666">3</span>], data<span style="color:#666">=</span>data1, ax <span style="color:#666">=</span> saxis[<span style="color:#666">0</span>,<span style="color:#666">1</span>])
sns<span style="color:#666">.</span>barplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;IsAlone&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, order<span style="color:#666">=</span>[<span style="color:#666">1</span>,<span style="color:#666">0</span>], data<span style="color:#666">=</span>data1, ax <span style="color:#666">=</span> saxis[<span style="color:#666">0</span>,<span style="color:#666">2</span>])

sns<span style="color:#666">.</span>pointplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;FareBin&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>,  data<span style="color:#666">=</span>data1, ax <span style="color:#666">=</span> saxis[<span style="color:#666">1</span>,<span style="color:#666">0</span>])
sns<span style="color:#666">.</span>pointplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;AgeBin&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>,  data<span style="color:#666">=</span>data1, ax <span style="color:#666">=</span> saxis[<span style="color:#666">1</span>,<span style="color:#666">1</span>])
sns<span style="color:#666">.</span>pointplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;FamilySize&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, data<span style="color:#666">=</span>data1, ax <span style="color:#666">=</span> saxis[<span style="color:#666">1</span>,<span style="color:#666">2</span>])
</code></pre></div><p><img src="https://i.imgur.com/15tR3oC.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">fig, (axis1,axis2,axis3) <span style="color:#666">=</span> plt<span style="color:#666">.</span>subplots(<span style="color:#666">1</span>,<span style="color:#666">3</span>,figsize<span style="color:#666">=</span>(<span style="color:#666">14</span>,<span style="color:#666">12</span>))

sns<span style="color:#666">.</span>boxplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Pclass&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Fare&#39;</span>, hue <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, data <span style="color:#666">=</span> data1, ax <span style="color:#666">=</span> axis1)
axis1<span style="color:#666">.</span>set_title(<span style="color:#ba2121">&#39;Pclass vs Fare Survival Comparison&#39;</span>)

sns<span style="color:#666">.</span>violinplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Pclass&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Age&#39;</span>, hue <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, data <span style="color:#666">=</span> data1, split <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>, ax <span style="color:#666">=</span> axis2)
axis2<span style="color:#666">.</span>set_title(<span style="color:#ba2121">&#39;Pclass vs Age Survival Comparison&#39;</span>)

sns<span style="color:#666">.</span>boxplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Pclass&#39;</span>, y <span style="color:#666">=</span><span style="color:#ba2121">&#39;FamilySize&#39;</span>, hue <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, data <span style="color:#666">=</span> data1, ax <span style="color:#666">=</span> axis3)
axis3<span style="color:#666">.</span>set_title(<span style="color:#ba2121">&#39;Pclass vs Family Size Survival Comparison&#39;</span>)
</code></pre></div><p><img src="https://i.imgur.com/XZZ2CCs.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">fig, qaxis <span style="color:#666">=</span> plt<span style="color:#666">.</span>subplots(<span style="color:#666">1</span>,<span style="color:#666">3</span>,figsize<span style="color:#666">=</span>(<span style="color:#666">14</span>,<span style="color:#666">12</span>))

sns<span style="color:#666">.</span>barplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Sex&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, hue <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Embarked&#39;</span>, data<span style="color:#666">=</span>data1, ax <span style="color:#666">=</span> qaxis[<span style="color:#666">0</span>])
axis1<span style="color:#666">.</span>set_title(<span style="color:#ba2121">&#39;Sex vs Embarked Survival Comparison&#39;</span>)

sns<span style="color:#666">.</span>barplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Sex&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, hue <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Pclass&#39;</span>, data<span style="color:#666">=</span>data1, ax  <span style="color:#666">=</span> qaxis[<span style="color:#666">1</span>])
axis1<span style="color:#666">.</span>set_title(<span style="color:#ba2121">&#39;Sex vs Pclass Survival Comparison&#39;</span>)

sns<span style="color:#666">.</span>barplot(x <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Sex&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, hue <span style="color:#666">=</span> <span style="color:#ba2121">&#39;IsAlone&#39;</span>, data<span style="color:#666">=</span>data1, ax  <span style="color:#666">=</span> qaxis[<span style="color:#666">2</span>])
axis1<span style="color:#666">.</span>set_title(<span style="color:#ba2121">&#39;Sex vs IsAlone Survival Comparison&#39;</span>)
</code></pre></div><p><img src="https://i.imgur.com/tjCrHia.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">fig, (maxis1, maxis2) <span style="color:#666">=</span> plt<span style="color:#666">.</span>subplots(<span style="color:#666">1</span>, <span style="color:#666">2</span>,figsize<span style="color:#666">=</span>(<span style="color:#666">14</span>,<span style="color:#666">12</span>))

sns<span style="color:#666">.</span>pointplot(x<span style="color:#666">=</span><span style="color:#ba2121">&#34;FamilySize&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121">&#34;Survived&#34;</span>, hue<span style="color:#666">=</span><span style="color:#ba2121">&#34;Sex&#34;</span>, data<span style="color:#666">=</span>data1,
              palette<span style="color:#666">=</span>{<span style="color:#ba2121">&#34;male&#34;</span>: <span style="color:#ba2121">&#34;blue&#34;</span>, <span style="color:#ba2121">&#34;female&#34;</span>: <span style="color:#ba2121">&#34;pink&#34;</span>},
              markers<span style="color:#666">=</span>[<span style="color:#ba2121">&#34;*&#34;</span>, <span style="color:#ba2121">&#34;o&#34;</span>], linestyles<span style="color:#666">=</span>[<span style="color:#ba2121">&#34;-&#34;</span>, <span style="color:#ba2121">&#34;--&#34;</span>], ax <span style="color:#666">=</span> maxis1)

sns<span style="color:#666">.</span>pointplot(x<span style="color:#666">=</span><span style="color:#ba2121">&#34;Pclass&#34;</span>, y<span style="color:#666">=</span><span style="color:#ba2121">&#34;Survived&#34;</span>, hue<span style="color:#666">=</span><span style="color:#ba2121">&#34;Sex&#34;</span>, data<span style="color:#666">=</span>data1,
              palette<span style="color:#666">=</span>{<span style="color:#ba2121">&#34;male&#34;</span>: <span style="color:#ba2121">&#34;blue&#34;</span>, <span style="color:#ba2121">&#34;female&#34;</span>: <span style="color:#ba2121">&#34;pink&#34;</span>},
              markers<span style="color:#666">=</span>[<span style="color:#ba2121">&#34;*&#34;</span>, <span style="color:#ba2121">&#34;o&#34;</span>], linestyles<span style="color:#666">=</span>[<span style="color:#ba2121">&#34;-&#34;</span>, <span style="color:#ba2121">&#34;--&#34;</span>], ax <span style="color:#666">=</span> maxis2)
</code></pre></div><p><img src="https://i.imgur.com/BWEwGST.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">e <span style="color:#666">=</span> sns<span style="color:#666">.</span>FacetGrid(data1, col <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Embarked&#39;</span>)
e<span style="color:#666">.</span>map(sns<span style="color:#666">.</span>pointplot, <span style="color:#ba2121">&#39;Pclass&#39;</span>, <span style="color:#ba2121">&#39;Survived&#39;</span>, <span style="color:#ba2121">&#39;Sex&#39;</span>, ci<span style="color:#666">=</span><span style="color:#666">95.0</span>, palette <span style="color:#666">=</span> <span style="color:#ba2121">&#39;deep&#39;</span>)
e<span style="color:#666">.</span>add_legend()
</code></pre></div><p><img src="https://i.imgur.com/ZsoaZ2X.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">a <span style="color:#666">=</span> sns<span style="color:#666">.</span>FacetGrid( data1, hue <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, aspect<span style="color:#666">=</span><span style="color:#666">4</span> )
a<span style="color:#666">.</span>map(sns<span style="color:#666">.</span>kdeplot, <span style="color:#ba2121">&#39;Age&#39;</span>, shade<span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span> )
a<span style="color:#666">.</span>set(xlim<span style="color:#666">=</span>(<span style="color:#666">0</span> , data1[<span style="color:#ba2121">&#39;Age&#39;</span>]<span style="color:#666">.</span>max()))
a<span style="color:#666">.</span>add_legend()
</code></pre></div><p><img src="https://i.imgur.com/R3rs1E3.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">h <span style="color:#666">=</span> sns<span style="color:#666">.</span>FacetGrid(data1, row <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Sex&#39;</span>, col <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Pclass&#39;</span>, hue <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>)
h<span style="color:#666">.</span>map(plt<span style="color:#666">.</span>hist, <span style="color:#ba2121">&#39;Age&#39;</span>, alpha <span style="color:#666">=</span> <span style="color:#666">.75</span>)
h<span style="color:#666">.</span>add_legend()
</code></pre></div><p><img src="https://i.imgur.com/pRXyPeP.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">pp <span style="color:#666">=</span> sns<span style="color:#666">.</span>pairplot(data1, hue <span style="color:#666">=</span> <span style="color:#ba2121">&#39;Survived&#39;</span>, palette <span style="color:#666">=</span> <span style="color:#ba2121">&#39;deep&#39;</span>, size<span style="color:#666">=</span><span style="color:#666">1.2</span>, diag_kind <span style="color:#666">=</span> <span style="color:#ba2121">&#39;kde&#39;</span>, diag_kws<span style="color:#666">=</span><span style="color:#008000">dict</span>(shade<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">True</span>), plot_kws<span style="color:#666">=</span><span style="color:#008000">dict</span>(s<span style="color:#666">=</span><span style="color:#666">10</span>) )
pp<span style="color:#666">.</span>set(xticklabels<span style="color:#666">=</span>[])
</code></pre></div><p><img src="https://i.imgur.com/3kGKe5G.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">correlation_heatmap</span>(df):
    _ , ax <span style="color:#666">=</span> plt<span style="color:#666">.</span>subplots(figsize <span style="color:#666">=</span>(<span style="color:#666">14</span>, <span style="color:#666">12</span>))
    colormap <span style="color:#666">=</span> sns<span style="color:#666">.</span>diverging_palette(<span style="color:#666">220</span>, <span style="color:#666">10</span>, as_cmap <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>)
    
    _ <span style="color:#666">=</span> sns<span style="color:#666">.</span>heatmap(
        df<span style="color:#666">.</span>corr(), 
        cmap <span style="color:#666">=</span> colormap,
        square<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">True</span>, 
        cbar_kws<span style="color:#666">=</span>{<span style="color:#ba2121">&#39;shrink&#39;</span>:<span style="color:#666">.9</span> }, 
        ax<span style="color:#666">=</span>ax,
        annot<span style="color:#666">=</span><span style="color:#008000;font-weight:bold">True</span>, 
        linewidths<span style="color:#666">=</span><span style="color:#666">0.1</span>,vmax<span style="color:#666">=</span><span style="color:#666">1.0</span>, linecolor<span style="color:#666">=</span><span style="color:#ba2121">&#39;white&#39;</span>,
        annot_kws<span style="color:#666">=</span>{<span style="color:#ba2121">&#39;fontsize&#39;</span>:<span style="color:#666">12</span> }
    )
    
    plt<span style="color:#666">.</span>title(<span style="color:#ba2121">&#39;Pearson Correlation of Features&#39;</span>, y<span style="color:#666">=</span><span style="color:#666">1.05</span>, size<span style="color:#666">=</span><span style="color:#666">15</span>)

correlation_heatmap(data1)
</code></pre></div><p><img src="https://i.imgur.com/RRobEOM.jpg" alt=""></p>
<h2 id="model-data">Model Data</h2>
<p>Data Science is a multidisciplinary field between mathematics (i.e. statistics, linear algebra, etc.), computer science (i.e. programming languages, computer systems, etc.) and business management (i.e. communication, subject-matter knowledge, etc.).
There are many machine learning algorithms, however they can be reduced to four categories: classification, regression, clustering, or dimensionality reduction, depending on your target variable and data modeling goals.
We can generalize that a continuous target variable requires a regression algorithm and a discrete target variable requires a classification algorithm.
Since our problem is predicting if a passenger survived or did not survive, this is a discrete target variable. We will use a classification algorithm from the sklearn library to begin our analysis.</p>
<p>We have implemented RandomForestClassifier, GaussianProcessClassifier, LogisticRegressionCV, GaussianNB, KNeighborsClassifier, DecisionTreeClassifier</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">MLA <span style="color:#666">=</span> [
    RandomForestClassifier(),
    GaussianProcessClassifier(),
    LogisticRegressionCV(),
    GaussianNB(),
    KNeighborsClassifier(),
    DecisionTreeClassifier(),
    ]

cv_split <span style="color:#666">=</span> ShuffleSplit(n_splits <span style="color:#666">=</span> <span style="color:#666">10</span>, test_size <span style="color:#666">=</span> <span style="color:#666">.3</span>, train_size <span style="color:#666">=</span> <span style="color:#666">.6</span>, random_state <span style="color:#666">=</span> <span style="color:#666">0</span> ) <span style="color:#408080;font-style:italic"># run model 10x with 60/30 split intentionally leaving out 10%</span>

MLA_columns <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;MLA Name&#39;</span>, <span style="color:#ba2121">&#39;MLA Parameters&#39;</span>,<span style="color:#ba2121">&#39;MLA Train Accuracy Mean&#39;</span>, <span style="color:#ba2121">&#39;MLA Test Accuracy Mean&#39;</span>, <span style="color:#ba2121">&#39;MLA Test Accuracy 3*STD&#39;</span> ,<span style="color:#ba2121">&#39;MLA Time&#39;</span>]
MLA_compare <span style="color:#666">=</span> pd<span style="color:#666">.</span>DataFrame(columns <span style="color:#666">=</span> MLA_columns)

MLA_predict <span style="color:#666">=</span> data1[Target]

row_index <span style="color:#666">=</span> <span style="color:#666">0</span>
<span style="color:#008000;font-weight:bold">for</span> alg <span style="color:#a2f;font-weight:bold">in</span> MLA:

    MLA_name <span style="color:#666">=</span> alg<span style="color:#666">.</span>__class__<span style="color:#666">.</span>__name__
    MLA_compare<span style="color:#666">.</span>loc[row_index, <span style="color:#ba2121">&#39;MLA Name&#39;</span>] <span style="color:#666">=</span> MLA_name
    MLA_compare<span style="color:#666">.</span>loc[row_index, <span style="color:#ba2121">&#39;MLA Parameters&#39;</span>] <span style="color:#666">=</span> <span style="color:#008000">str</span>(alg<span style="color:#666">.</span>get_params())
    
    cv_results <span style="color:#666">=</span> cross_validate(alg, data1[data1_x_bin], data1[Target], cv  <span style="color:#666">=</span> cv_split)

    MLA_compare<span style="color:#666">.</span>loc[row_index, <span style="color:#ba2121">&#39;MLA Time&#39;</span>] <span style="color:#666">=</span> cv_results[<span style="color:#ba2121">&#39;fit_time&#39;</span>]<span style="color:#666">.</span>mean()
    MLA_compare<span style="color:#666">.</span>loc[row_index, <span style="color:#ba2121">&#39;MLA Train Accuracy Mean&#39;</span>] <span style="color:#666">=</span> cv_results[<span style="color:#ba2121">&#39;score_time&#39;</span>]<span style="color:#666">.</span>mean()
    MLA_compare<span style="color:#666">.</span>loc[row_index, <span style="color:#ba2121">&#39;MLA Test Accuracy Mean&#39;</span>] <span style="color:#666">=</span> cv_results[<span style="color:#ba2121">&#39;test_score&#39;</span>]<span style="color:#666">.</span>mean()   
    MLA_compare<span style="color:#666">.</span>loc[row_index, <span style="color:#ba2121">&#39;MLA Test Accuracy 3*STD&#39;</span>] <span style="color:#666">=</span> cv_results[<span style="color:#ba2121">&#39;test_score&#39;</span>]<span style="color:#666">.</span>std()<span style="color:#666">*</span><span style="color:#666">3</span>
    

    alg<span style="color:#666">.</span>fit(data1[data1_x_bin], data1[Target])
    MLA_predict[MLA_name] <span style="color:#666">=</span> alg<span style="color:#666">.</span>predict(data1[data1_x_bin])
    
    row_index<span style="color:#666">+=</span><span style="color:#666">1</span>

    
MLA_compare<span style="color:#666">.</span>sort_values(by <span style="color:#666">=</span> [<span style="color:#ba2121">&#39;MLA Test Accuracy Mean&#39;</span>], ascending <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">False</span>, inplace <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">True</span>)
MLA_compare
</code></pre></div><p><img src="https://i.imgur.com/Na8VSiF.png" alt=""></p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">sns<span style="color:#666">.</span>barplot(x<span style="color:#666">=</span><span style="color:#ba2121">&#39;MLA Test Accuracy Mean&#39;</span>, y <span style="color:#666">=</span> <span style="color:#ba2121">&#39;MLA Name&#39;</span>, data <span style="color:#666">=</span> MLA_compare, color <span style="color:#666">=</span> <span style="color:#ba2121">&#39;m&#39;</span>)

plt<span style="color:#666">.</span>title(<span style="color:#ba2121">&#39;Machine Learning Algorithm Accuracy Score </span><span style="color:#b62;font-weight:bold">\n</span><span style="color:#ba2121">&#39;</span>)
plt<span style="color:#666">.</span>xlabel(<span style="color:#ba2121">&#39;Accuracy Score (%)&#39;</span>)
plt<span style="color:#666">.</span>ylabel(<span style="color:#ba2121">&#39;Algorithm&#39;</span>)
</code></pre></div><p><img src="https://i.imgur.com/07pNlTp.png" alt=""></p>
<p>We have achieved an accuracy of 83% by implementing Random Forest Classification.</p>
<h2 id="authors">Authors</h2>
<ul>
<li><a href="https://twitter.com/MvpAbhishek">ABhishek Bharadwaj</a></li>
<li><a href="https://twitter.com/SSVatsav">Sampat</a></li>
<li><a href="https://twitter.com/">RV Abhishek Barla</a></li>
<li><a href="https://twitter.com/rith_vik_7">Rithvik</a></li>
</ul>


    <footer class="site-footer">
  <span class="site-footer-credits">
    Copyright  2021 ABhishek Bharadwaj   from <a href="https://gohugo.io/">Hugo</a>.
  </span>
</footer>

  </section>
  
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-123456789-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

</body>
</html>
